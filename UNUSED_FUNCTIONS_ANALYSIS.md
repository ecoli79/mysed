# –ê–Ω–∞–ª–∏–∑ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ mayan_documents.py

## üî¥ –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. `temp_file_for_read()` (—Å—Ç—Ä–æ–∫–∏ 159-191)
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
- **–ü—Ä–∏—á–∏–Ω–∞:** –†–∞–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –≤ `preview_document_file()`, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–¥–∞–ª–∏—Ç—å, —Ç–∞–∫ –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–∞

### 2. `clear_metadata_cache()` (—Å—Ç—Ä–æ–∫–∏ 356-369)
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
- **–ü—Ä–∏—á–∏–Ω–∞:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, –Ω–æ –Ω–∏–≥–¥–µ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** 
  - –í–∞—Ä–∏–∞–Ω—Ç 1: –£–¥–∞–ª–∏—Ç—å, –µ—Å–ª–∏ –∫—ç—à –Ω–µ –Ω—É–∂–Ω–æ –æ—á–∏—â–∞—Ç—å –≤—Ä—É—á–Ω—É—é
  - –í–∞—Ä–∏–∞–Ω—Ç 2: –û—Å—Ç–∞–≤–∏—Ç—å, –µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∞

### 3. `show_grant_access_dialog()` (—Å—Ç—Ä–æ–∫–∏ 1353-1519)
- **–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–ù–ê
- **–ü—Ä–∏—á–∏–Ω–∞:** –í—ã–∑–æ–≤ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤ `create_document_card()` (—Å—Ç—Ä–æ–∫–∞ 1328-1330)
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
  - –í–∞—Ä–∏–∞–Ω—Ç 1: –£–¥–∞–ª–∏—Ç—å, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω
  - –í–∞—Ä–∏–∞–Ω—Ç 2: –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã–∑–æ–≤, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –Ω—É–∂–µ–Ω

## ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü:
- `content()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ main.py
- `search_content()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ main.py
- `upload_content()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ main.py
- `favorites_content()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ main.py

### –§—É–Ω–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:
- `load_recent_documents()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `content()` —á–µ—Ä–µ–∑ ui.timer
- `load_documents_by_cabinets()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `content()` —á–µ—Ä–µ–∑ ui.timer
- `load_favorite_documents()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `favorites_content()` —á–µ—Ä–µ–∑ ui.timer
- `search_documents()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `search_content()`

### –§—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏:
- `upload_document()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `upload_content()`
- `handle_file_upload()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `upload_document()`
- `download_document_file()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `create_document_card()`
- `download_signed_document()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `create_document_card()`
- `delete_document()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `create_document_card()`
- `toggle_favorite()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `create_document_card()`
- `check_favorite_status()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `create_document_card()`

### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- `sanitize_filename()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `safe_download_file()` –∏ `temp_file_for_read()`
- `cleanup_temp_files()` - —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `atexit.register()`
- `check_rate_limit()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö
- `get_rate_limit_status()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö
- `get_cached_document_types()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `SimpleFormDataExtractor`
- `get_cached_cabinets()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `SimpleFormDataExtractor` –∏ `load_documents_by_cabinets()`
- `get_cached_tags()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `SimpleFormDataExtractor`
- `load_previews_batch()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö
- `safe_download_file()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `download_document_file()` –∏ `download_signed_document()`
- `_extract_token_from_client()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `get_mayan_client()`
- `get_mayan_client()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ
- `check_connection()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö
- `with_timeout()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö
- `format_file_size()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö
- `format_datetime()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `create_document_card()`
- `update_file_size()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `create_document_card()`
- `update_preview_in_card()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `create_document_card()`
- `show_mayan_reauth_dialog()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `get_mayan_client()`

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:** 2-3 (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ—à–µ–Ω–∏—è –ø–æ `show_grant_access_dialog`)
- **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö:** 1 (`clear_metadata_cache` - –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–∞)
- **–ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:** 1 (`show_grant_access_dialog`)

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (—É–¥–∞–ª–∏—Ç—å):
1. **`temp_file_for_read()`** - —Ç–æ—á–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —É–¥–∞–ª–∏—Ç—å

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (—Ä–µ—à–∏—Ç—å):
2. **`clear_metadata_cache()`** - —Ä–µ—à–∏—Ç—å, –Ω—É–∂–Ω–∞ –ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞
3. **`show_grant_access_dialog()`** - —Ä–µ—à–∏—Ç—å, –Ω—É–∂–µ–Ω –ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞:
   - –ï—Å–ª–∏ –Ω—É–∂–µ–Ω - —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã–∑–æ–≤
   - –ï—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω - —É–¥–∞–ª–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é

## üíæ –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–∫–æ–Ω–æ–º–∏—è

–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:
- **`temp_file_for_read()`:** ~33 —Å—Ç—Ä–æ–∫–∏
- **`clear_metadata_cache()`:** ~14 —Å—Ç—Ä–æ–∫
- **`show_grant_access_dialog()`:** ~167 —Å—Ç—Ä–æ–∫ (–µ—Å–ª–∏ —É–¥–∞–ª–∏—Ç—å)

**–ò—Ç–æ–≥–æ:** ~214 —Å—Ç—Ä–æ–∫ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å (–µ—Å–ª–∏ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏)

